# 跨域
## 什么是跨域？
跨域是指浏览器不能执行其他网站的脚本。它是由浏览器的同源策略造成的，是浏览器对javascript实施的安全限制。如果协议、域名 或者端口有一个不同浏览器就认为是跨域。

## 浏览器的同源策略
浏览器最核心也最基本的安全功能，同源策略是要求协议、域名、端口保持一致就认为是同源的，同源的脚本才会被执行。同源策略是浏览器的行为，是为了保护本地数据不被JavaScript代码获取回来的数据污染，因此拦截的是客户端发出的请求回来的数据接收，即请求发送了，服务器响应了，但是无法被浏览器接收。    

同源策略限制了一下行为：  
* Cookie、LocalStorage 和 IndexDB 无法读取  
* DOM 和 JS 对象无法获取  
* Ajax请求失败(请求可发出，但响应被拦截)  

## 为什么要出现跨域？
CSRF（Cross Site Request Forgery, 跨站域请求伪造）是一种利用用户的登录态发起恶意请求的网络攻击。  

# 跨域的解决方案

## jsonp跨域
JSONP 的原理很简单，就是利用 <script> 标签没有跨域限制的漏洞。通过 <script> 标签指向一个需要访问的地址并提供一个回调 函数来接收数据当需要通讯时。
```html
<script src="http://domain/api? param1=a&param2=b&callback=jsonp"></script>
<script>
function jsonp(data) { 
  console.log(data)
} 
</script>

<!-- 多个地方都要请求时，可以封装一个方法，动态生成script标签请求 -->
<script>
function jsonp(url, jsonpCallback, success) { 
  let script = document.createElement('script') script.src = url
  script.async = true
  script.type = 'text/javascript' window[jsonpCallback] = function(data) {
  success && success(data) }
  document.body.appendChild(script) 
}
jsonp('http://xxx', 'callback', function(value) { 
  console.log(value)
})
</script>
```