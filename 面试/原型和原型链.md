# 原型
原型是function对象的一个prototype属性(公有属性)，它定义了构造函数制造出的对象的公共祖先。通过该构造函数产生的对象（即实例对象），可以继承该原型的属性和方法
```js
Person.prototype.job = "student"    // prototype属性就是Person方法的原型
function Person(name, age) {
  this.name = name;
  this.age = age;
  this.print = function() {
    console.log(this.name + '的年龄为' + this.age)
  }
}

var person = new Person("Mary", 16) // person就是通过Person构造出来的实例对象，它继承了Person的原型，即person.__proto__ = Person.prototype
person.print() // Mary的年龄为16

console.log(person) // Person { name: 'Mary', age: 16, print: [Function] }
console.log(person.__proto__) // Person { job: 'student' }
console.log(Person.prototype) // Person { job: 'student' }
console.log(person.__proto__.constructor) // [Function: Person]，指向构造函数
console.log(Person.prototype.constructor) // [Function: Person]

```

# 原型链
* 实例对象的__proto__是其隐式原型，而构造函数的prototype是显式原型  
* 原型链则是指从当前对象的原型中，一直往其上的原型遍历，直至到Object的原型（Object的隐式原型为{}，避免死循环）,这条链则称为原型链  

```js
function Dog() {
  this.sound = "wang"
}
function Haba() {
  this.sound = "wangwang"
}

Haba.prototype = new Dog()
haba = new Haba();
console.log(haba.__proto__) // { sound: 'wang' }
console.log(haba.__proto__.__proto__) // {}
// 
// 如以上例子的原型链为： 
// Haba.prototype-->Dog.prototype-->Object.prototype 
// 或者
// haba.__proto__(Dog.prototype)-->haba.__proto__.__proto__(Object.prototype)-->haba.__proto__.__proto__.__proto__({})
```


# new
当执行new xxx()时，实际上做了什么？
1. 创建一个空对象
2. 获取构造函数
3. 将空对象链接到构造函数的原型链
4. 改变构造函数中this指向空对象，并执行构造函数
5. 如果没有指定任何返回对象，则返回这个对象
```js
// 用上述例子，简单而言，就执行了以下步骤
var obj = {}
obj.__proto__ = Person.prototype
person = Person.apply(obj, arguments)
return person
```


## 手写实现一个new
```js
// 实现
function create(){
  //创建一个空对象
  let obj = new Object();
  //获取构造函数, create方法第一参数默认为构造函数，相当于执行arguments.shift()
  let Constructor = [].shift.call(arguments);
  //链接到原型
  obj.__proto__ = Constructor.prototype;
  //绑定this值：使用apply，将构造函数中的this指向新对象，这样新对象就可以访问构造函数中的属性和方法
  let result = Constructor.apply(obj,arguments);
  //返回新对象：如果返回值是一个对象就返回该对象，否则返回构造函数的一个实例对象
  return typeof result === "object" ? result : obj;
}


// 测试
function People(name,age){
  this.name = name;
  this.age = age;
}
//通过new创建构造实例
let people1 = new People('Jack',20);
console.log(people1.name) //Jack
console.log(people1.age) //20

//通过create方法创造实例
let people2 = create(People,'Rose',18);//调用自定义create实现new
console.log(people2.name) //Rose
console.log(people2.age) //18

```


参考：
原型链：https://blog.csdn.net/jianghao233/article/details/80274779
new: https://www.jianshu.com/p/b325dc4e73f6